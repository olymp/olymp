export var getRangeClientRectsChrome = function getRangeClientRectsChrome(range) {
  var tempRange = range.cloneRange();
  var clientRects = [];

  for (var ancestor = range.endContainer; ancestor != null; ancestor = ancestor.parentNode) {
    var atCommonAncestor = ancestor === range.commonAncestorContainer;
    if (atCommonAncestor) {
      tempRange.setStart(range.startContainer, range.startOffset);
    } else {
      tempRange.setStart(tempRange.endContainer, 0);
    }
    var rects = Array.from(tempRange.getClientRects());
    clientRects.push(rects);
    if (atCommonAncestor) {
      var _ref;

      clientRects.reverse();
      return (_ref = []).concat.apply(_ref, clientRects);
    }
    tempRange.setEndBefore(ancestor);
  }

  throw new Error('Found an unexpected detached subtree when getting range client rects.');
};

export var isChrome = typeof navigator !== 'undefined' && /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
export var getRangeClientRects = isChrome ? getRangeClientRectsChrome : function (range) {
  return Array.from(range.getClientRects());
};

export var getRangeBoundingClientRect = function getRangeBoundingClientRect(range) {
  var rects = getRangeClientRects(range);
  var top = 0;
  var right = 0;
  var bottom = 0;
  var left = 0;

  if (rects.length) {
    var _rects$ = rects[0];
    top = _rects$.top;
    right = _rects$.right;
    bottom = _rects$.bottom;
    left = _rects$.left;

    for (var ii = 1; ii < rects.length; ii++) {
      var rect = rects[ii];
      if (rect.height !== 0 || rect.width !== 0) {
        top = Math.min(top, rect.top);
        right = Math.max(right, rect.right);
        bottom = Math.max(bottom, rect.bottom);
        left = Math.min(left, rect.left);
      }
    }
  }

  return {
    top: top,
    right: right,
    bottom: bottom,
    left: left,
    width: right - left,
    height: bottom - top
  };
};

export var getVisibleSelectionRect = function getVisibleSelectionRect() {
  if (typeof window === 'undefined') {
    return null;
  }
  var selection = window.getSelection();
  if (!selection.rangeCount) {
    return null;
  }

  var range = selection.getRangeAt(0);
  var boundingRect = getRangeBoundingClientRect(range);
  var top = boundingRect.top,
      right = boundingRect.right,
      bottom = boundingRect.bottom,
      left = boundingRect.left;


  if (top === 0 && right === 0 && bottom === 0 && left === 0) {
    return null;
  }

  return boundingRect;
};

export var getCollapsedClientRect = function getCollapsedClientRect() {
  var selection = document.getSelection();
  if (selection.rangeCount === 0 || !selection.getRangeAt || !selection.getRangeAt(0) || !selection.getRangeAt(0).startContainer || !selection.getRangeAt(0).startContainer.getBoundingClientRect) {
    return null;
  }

  var node = selection.getRangeAt(0).startContainer;
  var rect = node.getBoundingClientRect();
  return rect;
};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBhY2thZ2VzL3NsYXRlL3V0aWxzL3JhbmdlLmVzNiJdLCJuYW1lcyI6WyJnZXRSYW5nZUNsaWVudFJlY3RzQ2hyb21lIiwicmFuZ2UiLCJ0ZW1wUmFuZ2UiLCJjbG9uZVJhbmdlIiwiY2xpZW50UmVjdHMiLCJhbmNlc3RvciIsImVuZENvbnRhaW5lciIsInBhcmVudE5vZGUiLCJhdENvbW1vbkFuY2VzdG9yIiwiY29tbW9uQW5jZXN0b3JDb250YWluZXIiLCJzZXRTdGFydCIsInN0YXJ0Q29udGFpbmVyIiwic3RhcnRPZmZzZXQiLCJyZWN0cyIsIkFycmF5IiwiZnJvbSIsImdldENsaWVudFJlY3RzIiwicHVzaCIsInJldmVyc2UiLCJjb25jYXQiLCJzZXRFbmRCZWZvcmUiLCJFcnJvciIsImlzQ2hyb21lIiwibmF2aWdhdG9yIiwidGVzdCIsInVzZXJBZ2VudCIsInZlbmRvciIsImdldFJhbmdlQ2xpZW50UmVjdHMiLCJnZXRSYW5nZUJvdW5kaW5nQ2xpZW50UmVjdCIsInRvcCIsInJpZ2h0IiwiYm90dG9tIiwibGVmdCIsImxlbmd0aCIsImlpIiwicmVjdCIsImhlaWdodCIsIndpZHRoIiwiTWF0aCIsIm1pbiIsIm1heCIsImdldFZpc2libGVTZWxlY3Rpb25SZWN0Iiwid2luZG93Iiwic2VsZWN0aW9uIiwiZ2V0U2VsZWN0aW9uIiwicmFuZ2VDb3VudCIsImdldFJhbmdlQXQiLCJib3VuZGluZ1JlY3QiLCJnZXRDb2xsYXBzZWRDbGllbnRSZWN0IiwiZG9jdW1lbnQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJub2RlIl0sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLElBQU1BLDRCQUE0QixTQUE1QkEseUJBQTRCLENBQUNDLEtBQUQsRUFBVztBQUNsRCxNQUFNQyxZQUFZRCxNQUFNRSxVQUFOLEVBQWxCO0FBQ0EsTUFBTUMsY0FBYyxFQUFwQjs7QUFFQSxPQUNFLElBQUlDLFdBQVdKLE1BQU1LLFlBRHZCLEVBRUVELFlBQVksSUFGZCxFQUdFQSxXQUFX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QyxVQUFVRyxVQUFWLENBQXFCLENBQXJCLENBQWQ7QUFDQSxNQUFNQyxlQUFlbkIsMkJBQTJCM0IsS0FBM0IsQ0FBckI7QUFSMkMsTUFTbkM0QixHQVRtQyxHQVNOa0IsWUFUTSxDQVNuQ2xCLEdBVG1DO0FBQUEsTUFTOUJDLEtBVDhCLEdBU05pQixZQVRNLENBUzlCakIsS0FUOEI7QUFBQSxNQVN2QkMsTUFUdUIsR0FTTmdCLFlBVE0sQ0FTdkJoQixNQVR1QjtBQUFBLE1BU2ZDLElBVGUsR0FTTmUsWUFUTSxDQVNmZixJQVRlOzs7QUFXM0MsTUFBSUgsUUFBUSxDQUFSLElBQWFDLFVBQVUsQ0FBdkIsSUFBNEJDLFdBQVcsQ0FBdkMsSUFBNENDLFNBQVMsQ0FBekQsRUFBNEQ7QUFDMUQsV0FBTyxJQUFQO0FBQ0Q7O0FBRUQsU0FBT2UsWUFBUDtBQUNELENBaEJNOztBQWtCUCxPQUFPLElBQU1DLHlCQUF5QixTQUF6QkEsc0JBQXlCLEdBQU07QUFDMUMsTUFBTUwsWUFBWU0sU0FBU0wsWUFBVCxFQUFsQjtBQUNBLE1BQ0VELFVBQVVFLFVBQVYsS0FBeUIsQ0FBekIsSUFDQSxDQUFDRixVQUFVRyxVQURYLElBRUEsQ0FBQ0gsVUFBVUcsVUFBVixDQUFxQixDQUFyQixDQUZELElBR0EsQ0FBQ0gsVUFBVUcsVUFBVixDQUFxQixDQUFyQixFQUF3Qm5DLGNBSHpCLElBSUEsQ0FBQ2dDLFVBQVVHLFVBQVYsQ0FBcUIsQ0FBckIsRUFBd0JuQyxjQUF4QixDQUF1Q3VDLHFCQUwxQyxFQU1FO0FBQ0EsV0FBTyxJQUFQO0FBQ0Q7O0FBRUQsTUFBTUMsT0FBT1IsVUFBVUcsVUFBVixDQUFxQixDQUFyQixFQUF3Qm5DLGNBQXJDO0FBQ0EsTUFBTXdCLE9BQU9nQixLQUFLRCxxQkFBTCxFQUFiO0FBQ0EsU0FBT2YsSUFBUDtBQUNELENBZk0iLCJmaWxlIjoicGFja2FnZXMvc2xhdGUvdXRpbHMvcmFuZ2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgZ2V0UmFuZ2VDbGllbnRSZWN0c0Nocm9tZSA9IChyYW5nZSkgPT4ge1xuICBjb25zdCB0ZW1wUmFuZ2UgPSByYW5nZS5jbG9uZVJhbmdlKCk7XG4gIGNvbnN0IGNsaWVudFJlY3RzID0gW107XG5cbiAgZm9yIChcbiAgICBsZXQgYW5jZXN0b3IgPSByYW5nZS5lbmRDb250YWluZXI7XG4gICAgYW5jZXN0b3IgIT0gbnVsbDtcbiAgICBhbmNlc3RvciA9IGFuY2VzdG9yLnBhcmVudE5vZGVcbiAgKSB7XG4gICAgY29uc3QgYXRDb21tb25BbmNlc3RvciA9IGFuY2VzdG9yID09PSByYW5nZS5jb21tb25BbmNlc3RvckNvbnRhaW5lcjtcbiAgICBpZiAoYXRDb21tb25BbmNlc3Rvcikge1xuICAgICAgdGVtcFJhbmdlLnNldFN0YXJ0KHJhbmdlLnN0YXJ0Q29udGFpbmVyLCByYW5nZS5zdGFydE9mZnNldCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRlbXBSYW5nZS5zZXRTdGFydCh0ZW1wUmFuZ2UuZW5kQ29udGFpbmVyLCAwKTtcbiAgICB9XG4gICAgY29uc3QgcmVjdHMgPSBBcnJheS5mcm9tKHRlbXBSYW5nZS5nZXRDbGllbnRSZWN0cygpKTtcbiAgICBjbGllbnRSZWN0cy5wdXNoKHJlY3RzKTtcbiAgICBpZiAoYXRDb21tb25BbmNlc3Rvcikge1xuICAgICAgY2xpZW50UmVjdHMucmV2ZXJzZSgpO1xuICAgICAgcmV0dXJuIFtdLmNvbmNhdCguLi5jbGllbnRSZWN0cyk7XG4gICAgfVxuICAgIHRlbXBSYW5nZS5zZXRFbmRCZWZvcmUoYW5jZXN0b3IpO1xuICB9XG5cbiAgdGhyb3cgbmV3IEVycm9yKFxuICAgICdGb3VuZCBhbiB1bmV4cGVjdGVkIGRldGFjaGVkIHN1YnRyZWUgd2hlbiBnZXR0aW5nIHJhbmdlIGNsaWVudCByZWN0cy4nXG4gICk7XG59O1xuXG5leHBvcnQgY29uc3QgaXNDaHJvbWUgPVxuICB0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJlxuICAvQ2hyb21lLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpICYmXG4gIC9Hb29nbGUgSW5jLy50ZXN0KG5hdmlnYXRvci52ZW5kb3IpO1xuZXhwb3J0IGNvbnN0IGdldFJhbmdlQ2xpZW50UmVjdHMgPSBpc0Nocm9tZVxuICA/IGdldFJhbmdlQ2xpZW50UmVjdHNDaHJvbWVcbiAgOiBmdW5jdGlvbiAocmFuZ2UpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShyYW5nZS5nZXRDbGllbnRSZWN0cygpKTtcbiAgfTtcblxuZXhwb3J0IGNvbnN0IGdldFJhbmdlQm91bmRpbmdDbGllbnRSZWN0ID0gKHJhbmdlKSA9PiB7XG4gIGNvbnN0IHJlY3RzID0gZ2V0UmFuZ2VDbGllbnRSZWN0cyhyYW5nZSk7XG4gIGxldCB0b3AgPSAwO1xuICBsZXQgcmlnaHQgPSAwO1xuICBsZXQgYm90dG9tID0gMDtcbiAgbGV0IGxlZnQgPSAwO1xuXG4gIGlmIChyZWN0cy5sZW5ndGgpIHtcbiAgICAoeyB0b3AsIHJpZ2h0LCBib3R0b20sIGxlZnQgfSA9IHJlY3RzWzBdKTtcbiAgICBmb3IgKGxldCBpaSA9IDE7IGlpIDwgcmVjdHMubGVuZ3RoOyBpaSsrKSB7XG4gICAgICBjb25zdCByZWN0ID0gcmVjdHNbaWldO1xuICAgICAgaWYgKHJlY3QuaGVpZ2h0ICE9PSAwIHx8IHJlY3Qud2lkdGggIT09IDApIHtcbiAgICAgICAgdG9wID0gTWF0aC5taW4odG9wLCByZWN0LnRvcCk7XG4gICAgICAgIHJpZ2h0ID0gTWF0aC5tYXgocmlnaHQsIHJlY3QucmlnaHQpO1xuICAgICAgICBib3R0b20gPSBNYXRoLm1heChib3R0b20sIHJlY3QuYm90dG9tKTtcbiAgICAgICAgbGVmdCA9IE1hdGgubWluKGxlZnQsIHJlY3QubGVmdCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB0b3AsXG4gICAgcmlnaHQsXG4gICAgYm90dG9tLFxuICAgIGxlZnQsXG4gICAgd2lkdGg6IHJpZ2h0IC0gbGVmdCxcbiAgICBoZWlnaHQ6IGJvdHRvbSAtIHRvcCxcbiAgfTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRWaXNpYmxlU2VsZWN0aW9uUmVjdCA9ICgpID0+IHtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7IHJldHVybiBudWxsOyB9XG4gIGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTtcbiAgaWYgKCFzZWxlY3Rpb24ucmFuZ2VDb3VudCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgY29uc3QgcmFuZ2UgPSBzZWxlY3Rpb24uZ2V0UmFuZ2VBdCgwKTtcbiAgY29uc3QgYm91bmRpbmdSZWN0ID0gZ2V0UmFuZ2VCb3VuZGluZ0NsaWVudFJlY3QocmFuZ2UpO1xuICBjb25zdCB7IHRvcCwgcmlnaHQsIGJvdHRvbSwgbGVmdCB9ID0gYm91bmRpbmdSZWN0O1xuXG4gIGlmICh0b3AgPT09IDAgJiYgcmlnaHQgPT09IDAgJiYgYm90dG9tID09PSAwICYmIGxlZnQgPT09IDApIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJldHVybiBib3VuZGluZ1JlY3Q7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0Q29sbGFwc2VkQ2xpZW50UmVjdCA9ICgpID0+IHtcbiAgY29uc3Qgc2VsZWN0aW9uID0gZG9jdW1lbnQuZ2V0U2VsZWN0aW9uKCk7XG4gIGlmIChcbiAgICBzZWxlY3Rpb24ucmFuZ2VDb3VudCA9PT0gMCB8fFxuICAgICFzZWxlY3Rpb24uZ2V0UmFuZ2VBdCB8fFxuICAgICFzZWxlY3Rpb24uZ2V0UmFuZ2VBdCgwKSB8fFxuICAgICFzZWxlY3Rpb24uZ2V0UmFuZ2VBdCgwKS5zdGFydENvbnRhaW5lciB8fFxuICAgICFzZWxlY3Rpb24uZ2V0UmFuZ2VBdCgwKS5zdGFydENvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3RcbiAgKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBjb25zdCBub2RlID0gc2VsZWN0aW9uLmdldFJhbmdlQXQoMCkuc3RhcnRDb250YWluZXI7XG4gIGNvbnN0IHJlY3QgPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICByZXR1cm4gcmVjdDtcbn07XG4iXX0=
